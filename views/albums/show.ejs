<% include ../partials/header %>
<div class="display: flex; pageTitle">
    <h1 style="margin: 0; padding: 6px"><%= album.name %></h1>
</div>

<div class="container">
    <div class="row">
        <div style="background-color:rgba(2, 43, 88, 0.15); padding-top: 10px" class="col-md-3">
            <p class="lead">Album Ranking</p>
            <div class="list-group">
                <li class="list-group-item">2017</li>
                <li class="list-group-item">2018</li>
                <li class="list-group-item active">2019</li>
            </div>
        </div>
        <div class="col-md-9, text-center">
            <div class="thumbnail imgShow">
                <div class="artist">
                    <h3 style="margin: 0 auto">- <%= album.artist %> -</h3></span>
                </div>
                <img class="img-responsive" style="width:100%;
                height:100%;
                overflow:hidden;
                background-position:center center;
                background-repeat:no-repeat;
                background-size:cover" src="<%= album.image %>">

                <div class="caption-full">
                    <p style="padding: 10px 6px 2px"><strong>About: </strong><%= album.about %></p>
                    <p><em>Submitted By: <%=album.author.username%> on <%=album.created%></em></p>
                    <div class="row" style="margin: 0">
                        <a class="btn purpleBtn col-xs-12 col-md-4" id="toAlbums" href="/music">Back to Albums</a> 
                        <span class="col-xs-12 col-md-4" style="text-align: center"></span>
                        <a class="btn blueBtn col-xs-12 col-md-4" href="/music/<%=album._id%>/comments/new">Add a Comment</a>
                    </div>
                </div>
            </div>

            <% album.comments.forEach(comment=>{ %>
                <div class="well row" style="width: 50%; margin: 5px auto">
                    <div class="row">
                        <div class="col-xs-12 col-sm-6">
                            <span class=pull-left><strong><%= comment.author.username%></strong></span>   
                        </div>  
                        <div class="col-xs-12 col-sm-6">
                            <span class="pull-right">Date here</span>
                        </div> 
                    </div>
                    <div class="row">
                        <div style="padding: 15px">
                            <span class="pull-left"> <%= comment.text %></span>
                        </div>
                    </div>
                    <% if (currentUser && comment.author.id.equals(currentUser._id)){ %>
                        <div class="row" style="padding-top: 10px">
                            <div class="col-xs-12 col-sm-4">
                                    <form action="/music/<%= album._id%>/comments/<%=comment._id %>?_method=DELETE" method="POST">
                                        <button class="btn btn-sm btn-danger whiteText">Delete Comment</button>
                                    </form>
                            </div>
                            <div class="col-xs-12 col-sm-4"></div>
                            <div class="col-xs-12 col-sm-4">
                                    <a class="btn btn-sm blueBtn" href="/music/<%= album._id%>/comments/<%=comment._id %>/edit">Edit Comment</a>
                            </div>
                        </div>                           
                     <% } %>     
                </div>
            <% }) %>  
        </div>   
    </div>
</div>  

<% if(currentUser && album.author.id.equals(currentUser._id)){
    console.log(currentUser) %>
    <div style="float:right">
        <a class="btn blueBtn" href="/music/<%= album._id %>/edit">Edit Album</a>
        <form action="/music/<%= album._id %>?_method=DELETE" method="POST">
            <button class="btn btn-sm btn-danger">Delete Album</button>
        </form>
    </div>
<% } %>

<% include ../partials/footer %>